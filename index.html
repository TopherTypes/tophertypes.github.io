<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Personal Organiser</title>
  <link rel="stylesheet" href="app.css" />
</head>
<body>
  <!-- Top navigation with status and sync controls -->
  <header class="topbar">
    <div class="topbar__left">
      <div class="brand">
        <div class="brand__title">Personal Organiser</div>
        <div class="brand__subtitle">Offline-first • Drive sync • Modular planning workspace</div>
      </div>
    </div>

    <div class="topbar__right">
      <div class="statuspill" id="net_status">Checking network…</div>
      <div class="statuspill" id="sync_status">Local only</div>

      <button class="btn" id="auth_btn">Sign in</button>
      <button class="btn btn--ghost" id="signout_btn">Sign out</button>

      <button class="btn btn--primary" id="sync_btn">Sync</button>
    </div>
  </header>

  <!-- Primary app layout -->
  <main class="layout">
    <!-- Main module navigation -->
    <nav class="module-tabs" aria-label="Primary modules">
      <button class="module-tab is-active" data-module="meetings">Meetings</button>
      <!-- Centralized update queue for meeting and ad-hoc updates. -->
      <button class="module-tab" data-module="update_queue">Update queue</button>
      <button class="module-tab" data-module="projects">Projects</button>
      <button class="module-tab" data-module="people">People</button>
      <button class="module-tab" data-module="tasks">Tasks</button>
      <button class="module-tab" data-module="settings">Settings</button>
      <!-- Distinct utility entry for ad-hoc updates outside of meeting workflows. -->
      <button class="module-tab module-tab--utility" id="ad_hoc_update_btn" type="button">+ Ad-hoc update</button>
    </nav>

    <!-- Meetings module -->
    <section class="module-panel is-active" id="module_meetings">
      <div class="module-header">
        <div>
          <h2>Meetings module</h2>
          <div class="muted">Schedule, capture notes, and track meeting-driven work.</div>
        </div>
      </div>

      <nav class="module-subtabs" aria-label="Meeting workspace tabs">
        <button class="module-subtab is-active" data-module-tab="meeting">Meeting</button>
        <button class="module-subtab" data-module-tab="updates">Updates</button>
        <button class="module-subtab" data-module-tab="actions">My Actions</button>
        <button class="module-subtab" data-module-tab="topics">Projects</button>
        <button class="module-subtab" data-module-tab="search">Search</button>
      </nav>

      <!-- Meeting setup + notes workflow -->
      <section class="module-section is-active" id="module_tab_meeting">
        <div class="meeting-shell">
          <div class="meeting-shell__header">
            <div>
              <h2>Meeting workspace</h2>
              <div class="muted">Plan meetings in the calendar, then switch to Notes for a focused capture view.</div>
            </div>
            <div class="segmented" role="tablist" aria-label="Meeting views">
              <button class="segmented__btn is-active" type="button" data-meeting-view="setup" role="tab" aria-controls="meeting_view_setup" aria-selected="true">Schedule</button>
              <button class="segmented__btn" type="button" data-meeting-view="notes" role="tab" aria-controls="meeting_view_notes" aria-selected="false">Notes</button>
            </div>
          </div>
        </div>

        <!-- Meeting scheduling view -->
        <div class="meeting-view is-active" data-meeting-view-panel="setup" id="meeting_view_setup" role="tabpanel">
          <div class="card meeting-calendar">
            <div class="calendar-header">
              <div>
                <h2>Meeting calendar</h2>
                <div class="muted">Scan every scheduled meeting and use the Edit/Notes buttons to jump into the right workflow.</div>
              </div>
              <div class="calendar-controls">
                <div class="segmented" role="tablist" aria-label="Calendar view">
                  <button class="segmented__btn is-active" type="button" data-calendar-view="week">Week</button>
                  <button class="segmented__btn" type="button" data-calendar-view="month">Month</button>
                </div>
                <div class="calendar-nav">
                  <button class="btn btn--ghost" type="button" data-calendar-nav="prev">◀</button>
                  <button class="btn btn--ghost" type="button" data-calendar-nav="today">Today</button>
                  <button class="btn btn--ghost" type="button" data-calendar-nav="next">▶</button>
                </div>
              </div>
            </div>
            <div class="calendar-range muted" id="calendar_range"></div>
            <div id="meeting_calendar"></div>
          </div>

          <div class="grid2">
            <div class="card">
              <h2>Create meeting</h2>

              <div class="row row--space">
                <button class="btn btn--primary" id="meeting_open_lightbox_btn">New meeting</button>
              </div>

              <p class="muted">Use the calendar cards below to edit meeting details or jump straight into notes.</p>

              <hr />

              <div class="formrow">
                <label>Current meeting</label>
                <div class="muted" id="current_meeting_label">None selected.</div>
              </div>

              <div class="row row--space">
                <button class="btn" id="download_meeting_summary_btn">Copy meeting summary</button>
                <button class="btn btn--ghost" id="delete_meeting_btn">Delete meeting</button>
              </div>
            </div>

            <div class="card">
              <h2>Quick lookup</h2>
              <div class="formrow">
                <label>Search past notes</label>
                <input id="quick_search" type="text" placeholder="Type to search…" />
              </div>
              <div id="quick_search_results" class="list"></div>
            </div>
          </div>
        </div>

        <!-- Meeting notes capture view -->
        <div class="meeting-view" data-meeting-view-panel="notes" id="meeting_view_notes" role="tabpanel" hidden>
          <div class="card meeting-notes-card" id="meeting_work_area">
            <h2>Meeting notes</h2>
            <div class="muted">Create or open a meeting to start taking notes.</div>
          </div>
        </div>
      </section>

      <!-- Updates status by person -->
      <section class="module-section" id="module_tab_updates">
        <div class="card">
          <h2>Updates by person</h2>

          <div class="grid2">
            <div>
              <div class="formrow">
                <label>Person</label>
                <select id="updates_person"></select>
              </div>

              <div class="formrow">
                <label>Project</label>
                <select id="updates_project"></select>
              </div>

              <div class="row row--space">
                <button class="btn btn--primary" id="mark_updates_btn">Mark all shown as updated</button>
                <button class="btn" id="copy_updates_btn">Copy updates text</button>
              </div>

              <p class="muted">
                This marks updates only for the selected person — if an item also targets other people,
                it stays pending for them.
              </p>
            </div>

            <div>
              <div class="formrow">
                <label>Filter</label>
                <input id="updates_filter" type="text" placeholder="Filter pending updates…" />
              </div>
              <div class="muted" id="updates_count"></div>
            </div>
          </div>

          <div id="updates_list" class="list"></div>
        </div>
      </section>

      <!-- Action items assigned to the current user -->
      <section class="module-section" id="module_tab_actions">
        <div class="card">
          <h2>My Actions</h2>

          <div class="filters">
            <div class="formrow">
              <label>Owner</label>
              <select id="actions_owner"></select>
            </div>

            <div class="formrow">
              <label>Project</label>
              <select id="actions_topic"></select>
            </div>

            <div class="formrow">
              <label>Status</label>
              <select id="actions_status">
                <option value="">Any status</option>
                <option value="open">Open</option>
                <option value="in_progress">In progress</option>
                <option value="blocked">Blocked</option>
                <option value="done">Done</option>
              </select>
            </div>
          </div>

          <div class="muted" id="actions_count"></div>
          <div id="actions_list" class="list"></div>
        </div>
      </section>

      <!-- Project management and history -->
      <section class="module-section" id="module_tab_topics">
        <div class="card">
          <div class="row row--space">
            <h2>Project overview</h2>
            <button class="btn btn--primary" id="project_open_lightbox_btn" type="button">New project</button>
          </div>

          <div class="grid2">
            <div class="formrow">
              <label>Project</label>
              <select id="topics_topic"></select>
            </div>

            <div class="formrow">
              <label>Focus</label>
              <select id="topics_focus">
                <option value="overview">Overview</option>
                <option value="actions">Open actions</option>
                <option value="decisions">Decisions</option>
                <option value="questions">Questions</option>
                <option value="info">Information</option>
              </select>
            </div>
          </div>

          <div id="topic_output" class="list"></div>
        </div>
      </section>

      <!-- Search across meetings and notes -->
      <section class="module-section" id="module_tab_search">
        <div class="card">
          <h2>Search everything</h2>
          <div class="grid2">
            <div class="formrow">
              <label>Search</label>
              <input id="search_query" type="text" placeholder="e.g., 'supplier', 'decision', 'Afonso'…" />
            </div>
            <div class="formrow">
              <label>Type</label>
              <select id="search_type">
                <option value="all">All</option>
                <option value="info">Info</option>
                <option value="question">Question</option>
                <option value="decision">Decision</option>
                <option value="action">Action</option>
              </select>
            </div>
          </div>
          <div id="search_results" class="list"></div>
        </div>
      </section>

      <!-- Meeting creation lightbox -->
      <div class="lightbox" id="meeting_lightbox" aria-hidden="true">
        <div class="lightbox__backdrop" data-lightbox-close="true"></div>
        <div class="lightbox__panel" role="dialog" aria-modal="true" aria-labelledby="meeting_lightbox_title">
          <div class="lightbox__header">
            <h3 id="meeting_lightbox_title">Create a meeting</h3>
            <button class="iconbtn" data-lightbox-close="true" aria-label="Close meeting form">✕</button>
          </div>
          <div class="formrow">
            <label>Template</label>
            <select id="meeting_template"></select>
          </div>
          <div class="formrow">
            <label>Project</label>
            <div class="row">
              <select id="meeting_topic"></select>
              <button class="btn btn--ghost" id="add_topic_btn" type="button">New project</button>
            </div>
          </div>
          <div class="formrow">
            <label>Meeting title (optional)</label>
            <input id="meeting_title" type="text" placeholder="e.g., Weekly catch-up" />
          </div>
          <div class="formrow" id="meeting_one_to_one_fields" hidden>
            <label>1:1 counterpart <span class="field-tag field-tag--required is-hidden" data-required-tag="oneToOneTarget">Required</span></label>
            <div class="grid2">
              <div class="formrow">
                <label>Person</label>
                <select id="meeting_one_to_one_person"></select>
              </div>
              <div class="formrow">
                <label>Group</label>
                <select id="meeting_one_to_one_group"></select>
              </div>
            </div>
            <div class="muted">Choose either a person or a group for this 1:1.</div>
          </div>
          <div class="formrow">
            <label>Date/time</label>
            <input id="meeting_datetime" type="datetime-local" />
          </div>
          <div class="row row--space">
            <button class="btn btn--danger" id="meeting_delete_btn" type="button" hidden>Delete meeting</button>
            <div class="row">
              <button class="btn btn--primary" id="create_meeting_btn">Create meeting</button>
              <button class="btn btn--ghost" data-lightbox-close="true" type="button">Cancel</button>
            </div>
          </div>
        </div>
      </div>

    </section>

    <!-- Update queue module -->
    <section class="module-panel" id="module_update_queue">
      <div class="module-header">
        <div>
          <h2>Update queue</h2>
          <div class="muted">Review meeting and ad-hoc updates together, then narrow the view with filters.</div>
        </div>
      </div>

      <div class="card">
        <h2>All updates</h2>
        <div class="muted">Showing updates across every meeting and ad-hoc capture by default.</div>

        <div class="filters">
          <div class="formrow">
            <label>Person</label>
            <select id="update_queue_person"></select>
          </div>

          <div class="formrow">
            <label>Project</label>
            <select id="update_queue_project"></select>
          </div>

          <div class="formrow">
            <label>Type</label>
            <select id="update_queue_type">
              <option value="">All types</option>
              <option value="update">Update</option>
              <option value="action">Action</option>
              <option value="decision">Decision</option>
              <option value="question">Question</option>
              <option value="info">Information</option>
            </select>
          </div>

          <div class="formrow">
            <label>Status</label>
            <select id="update_queue_status">
              <option value="" selected>All updates</option>
              <option value="pending">Pending updates</option>
              <option value="updated">Fully updated</option>
            </select>
          </div>
        </div>

        <div class="muted" id="update_queue_count"></div>
        <div id="update_queue_list" class="list"></div>
      </div>
    </section>

    <!-- People module -->
    <section class="module-panel" id="module_projects">
      <div class="module-header">
        <div>
          <h2>Projects module</h2>
          <div class="muted">Centralize project context, timelines, and decisions in one workspace.</div>
        </div>
      </div>

      <div class="grid2">
        <div class="card">
          <div class="row row--space">
            <h2>Project navigator</h2>
            <button class="btn btn--primary" id="project_module_new_btn" type="button">New project</button>
          </div>
          <div class="formrow">
            <label>Project</label>
            <select id="project_select"></select>
          </div>
          <div class="muted" id="project_summary">Select a project to see a quick summary.</div>
        </div>

        <div class="card">
          <div class="row row--space">
            <h2>Project details</h2>
            <div class="row">
              <button class="btn btn--danger" id="project_delete_btn" type="button">Delete project</button>
              <button class="btn btn--ghost" id="project_reset_btn" type="button">Reset</button>
              <button class="btn btn--primary" id="project_save_btn" type="button">Save details</button>
            </div>
          </div>
          <div id="project_details_form"></div>
          <div class="item__error" id="project_details_error" hidden></div>
        </div>
      </div>

      <div class="grid2">
        <div class="card">
          <h2>Actions timeline</h2>
          <div class="muted">Track action items in chronological order for this project.</div>
          <div class="timeline" id="project_actions_timeline"></div>
        </div>

        <div class="card">
          <h2>Decision log</h2>
          <div class="muted">Review decisions captured in meetings.</div>
          <div class="list" id="project_decision_log"></div>
        </div>
      </div>

      <div class="card">
        <h2>Meetings</h2>
        <div class="muted">All meetings tagged to this project.</div>
        <div class="list list--compact" id="project_meetings_list"></div>
      </div>
    </section>

    <!-- People module -->
    <section class="module-panel" id="module_people">
      <div class="grid2">
        <div class="card">
          <div class="row row--space">
            <h2>People</h2>
            <button class="btn btn--primary" id="person_new_btn">New person</button>
          </div>
          <div id="people_list" class="list list--scroll-people"></div>
        </div>

        <div class="card">
          <div class="row row--space">
            <h2>Person details</h2>
            <div class="row">
              <button class="btn btn--ghost" id="person_cancel_btn">Cancel</button>
              <button class="btn btn--primary" id="person_save_btn">Save</button>
            </div>
          </div>
          <div id="person_editor"></div>
        </div>
      </div>

      <!-- Group creation and management now live alongside people records. -->
      <div class="grid2">
        <div class="card">
          <h2>Groups</h2>
          <div class="row row--space">
            <div class="muted">Create a group to reuse across meetings.</div>
            <button class="btn btn--primary" id="group_open_lightbox_btn">New group</button>
          </div>
          <div class="muted">Groups expand to people at the time you tag an item.</div>
          <div id="groups_list" class="list"></div>
        </div>

        <div class="card">
          <h2>Group guidance</h2>
          <div class="muted">
            Use groups to quickly target recurring teams, stakeholders, or project cohorts. Update membership here to keep
            future notes and action items aligned.
          </div>
        </div>
      </div>

      <div class="grid2">
        <div class="card">
          <h2>Owned updates</h2>
          <div class="muted">Items where this person is the owner.</div>
          <div id="person_owned_updates" class="list"></div>
        </div>

        <div class="card">
          <h2>Needs updates</h2>
          <div class="muted">Items where this person is an update target.</div>
          <div id="person_target_updates" class="list"></div>
        </div>
      </div>

      <!-- Person creation lightbox -->
      <div class="lightbox" id="person_lightbox" aria-hidden="true">
        <div class="lightbox__backdrop" data-lightbox-close="true"></div>
        <div class="lightbox__panel" role="dialog" aria-modal="true" aria-labelledby="person_lightbox_title">
          <div class="lightbox__header">
            <h3 id="person_lightbox_title">Add a person</h3>
            <button class="iconbtn" data-lightbox-close="true" aria-label="Close person form">✕</button>
          </div>
          <div class="formrow">
            <label>Name</label>
            <input id="person_create_name" type="text" placeholder="e.g., Jordan Lee" />
          </div>
          <div class="formrow">
            <label>Email</label>
            <input id="person_create_email" type="email" placeholder="e.g., jordan@company.com" />
          </div>
          <div class="formrow">
            <label>Organisation</label>
            <input id="person_create_org" type="text" placeholder="e.g., Northwind Labs" />
          </div>
          <div class="formrow">
            <label>Job title</label>
            <input id="person_create_title" type="text" placeholder="e.g., Product lead" />
          </div>
          <div class="item__error" id="person_lightbox_error" hidden></div>
          <div class="row row--space">
            <button class="btn btn--primary" id="person_create_btn">Add person</button>
            <button class="btn btn--ghost" data-lightbox-close="true" type="button">Cancel</button>
          </div>
        </div>
      </div>

      <!-- Group creation lightbox -->
      <div class="lightbox" id="group_lightbox" aria-hidden="true">
        <div class="lightbox__backdrop" data-lightbox-close="true"></div>
        <div class="lightbox__panel" role="dialog" aria-modal="true" aria-labelledby="group_lightbox_title">
          <div class="lightbox__header">
            <h3 id="group_lightbox_title">Add a group</h3>
            <button class="iconbtn" data-lightbox-close="true" aria-label="Close group form">✕</button>
          </div>
          <div class="formrow">
            <label>Group name</label>
            <input id="group_name_input" type="text" placeholder="e.g., Steering committee" />
          </div>
          <div class="item__error" id="group_lightbox_error" hidden></div>
          <div class="row row--space">
            <button class="btn btn--primary" id="group_add_btn">Add group</button>
            <button class="btn btn--ghost" data-lightbox-close="true" type="button">Cancel</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Tasks module -->
    <section class="module-panel" id="module_tasks">
      <div class="module-header">
        <div>
          <h2>Tasks module</h2>
          <div class="muted">Capture personal to-dos and track progress in one place. Action items owned by “Me” appear here automatically.</div>
        </div>
      </div>

      <div class="card">
        <div class="row row--space">
          <div>
            <h2>Tasks</h2>
            <div class="muted">Sorted by due date, priority, and status.</div>
          </div>
          <div class="row">
            <button class="btn btn--primary" id="task_open_modal_btn">Add task</button>
            <select id="task_filter_status">
              <option value="">All statuses</option>
              <option value="todo">To do</option>
              <option value="in_progress">In progress</option>
              <option value="blocked">Blocked</option>
              <option value="done">Done</option>
            </select>
            <select id="task_filter_priority">
              <option value="">All priorities</option>
              <option value="low">Low</option>
              <option value="medium">Medium</option>
              <option value="high">High</option>
            </select>
          </div>
        </div>
        <div class="muted" id="tasks_count"></div>
        <div id="tasks_list" class="list"></div>
      </div>

      <div class="lightbox" id="task_lightbox" aria-hidden="true">
        <div class="lightbox__backdrop" data-lightbox-close="true"></div>
        <div class="lightbox__panel" role="dialog" aria-modal="true" aria-labelledby="task_lightbox_title">
          <div class="lightbox__header">
            <h3 id="task_lightbox_title">Add a task</h3>
            <button class="iconbtn" data-lightbox-close="true" aria-label="Close task form">✕</button>
          </div>
          <div class="formrow">
            <label>Task title</label>
            <input id="task_title" type="text" placeholder="e.g., Review contract updates" />
          </div>
          <div class="formrow">
            <label>Notes</label>
            <textarea id="task_notes" placeholder="Capture context or next steps…"></textarea>
          </div>
          <div class="grid2">
            <div class="formrow">
              <label>Owner</label>
              <select id="task_owner"></select>
            </div>
            <div class="formrow">
              <label>Priority</label>
              <select id="task_priority">
                <option value="low">Low</option>
                <option value="medium" selected>Medium</option>
                <option value="high">High</option>
              </select>
            </div>
          </div>
          <div class="grid2">
            <div class="formrow">
              <label>Due date</label>
              <input id="task_due" type="date" />
            </div>
            <div class="formrow">
              <label>Link</label>
              <input id="task_link" type="url" placeholder="https://…" />
            </div>
          </div>
          <div class="formrow">
            <label>Status</label>
            <select id="task_status">
              <option value="todo">To do</option>
              <option value="in_progress">In progress</option>
              <option value="blocked">Blocked</option>
              <option value="done">Done</option>
            </select>
          </div>
          <div class="formrow">
            <label>Update targets</label>
            <input id="task_update_targets" type="text" list="task_targets_list" placeholder="Add names separated by commas" />
            <datalist id="task_targets_list"></datalist>
          </div>
          <div class="row row--space">
            <button class="btn btn--primary" id="task_add_btn">Add task</button>
            <button class="btn btn--ghost" id="task_clear_btn" type="button">Clear</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Ad-hoc update capture lightbox -->
    <div class="lightbox" id="update_lightbox" aria-hidden="true">
      <div class="lightbox__backdrop" data-lightbox-close="true"></div>
      <div class="lightbox__panel" role="dialog" aria-modal="true" aria-labelledby="update_lightbox_title">
        <div class="lightbox__header">
          <h3 id="update_lightbox_title">Add an ad-hoc update</h3>
          <button class="iconbtn" data-lightbox-close="true" aria-label="Close update form">✕</button>
        </div>
        <div class="formrow">
          <label>Update summary</label>
          <input id="update_title" type="text" placeholder="e.g., Customer rollout is underway" />
        </div>
        <div class="formrow">
          <label>Notes</label>
          <textarea id="update_notes" placeholder="Capture context, risks, or blockers…"></textarea>
        </div>
        <div class="grid2">
          <div class="formrow">
            <label>Project</label>
            <select id="update_topic"></select>
          </div>
          <div class="formrow">
            <label>Owner</label>
            <select id="update_owner"></select>
          </div>
        </div>
        <div class="grid2">
          <div class="formrow">
            <label>Update type</label>
            <select id="update_type">
              <option value="update" selected>Update</option>
              <option value="action">Action</option>
              <option value="decision">Decision</option>
              <option value="question">Question</option>
              <option value="info">Information</option>
            </select>
          </div>
          <div class="formrow">
            <label>Status</label>
            <select id="update_status">
              <option value="">— None —</option>
              <option value="open">Open</option>
              <option value="in_progress">In progress</option>
              <option value="blocked">Blocked</option>
              <option value="done">Done</option>
            </select>
          </div>
        </div>
        <div class="grid2">
          <div class="formrow">
            <label>Priority</label>
            <select id="update_priority">
              <option value="low">Low</option>
              <option value="medium" selected>Medium</option>
              <option value="high">High</option>
            </select>
          </div>
          <div class="formrow">
            <label>Due date</label>
            <input id="update_due" type="date" />
          </div>
        </div>
        <div class="formrow">
          <label>Link</label>
          <input id="update_link" type="url" placeholder="https://…" />
        </div>
        <div class="formrow">
          <label>Update targets</label>
          <input id="update_targets" type="text" list="update_targets_list" placeholder="Add names separated by commas" />
          <datalist id="update_targets_list"></datalist>
        </div>
        <div class="item__error" id="update_lightbox_error" hidden></div>
        <div class="row row--space">
          <button class="btn btn--primary" id="update_add_btn">Save update</button>
          <button class="btn btn--ghost" id="update_clear_btn" type="button">Clear</button>
        </div>
      </div>
    </div>

    <!-- Settings and data export -->
    <section class="module-panel" id="module_settings">
      <div class="grid2">
        <div class="card">
          <h2>Sync preferences</h2>
          <div class="formrow">
            <label for="sync_frequency">Sync frequency</label>
            <select id="sync_frequency" data-setting-path="sync.frequencyMinutes" data-setting-type="number">
              <option value="0">Manual only</option>
              <option value="15">Every 15 minutes</option>
              <option value="30">Every 30 minutes</option>
              <option value="60">Hourly</option>
              <option value="240">Every 4 hours</option>
            </select>
          </div>
          <div class="formrow">
            <label>
              <input type="checkbox" id="sync_on_launch" data-setting-path="sync.autoSyncOnLaunch" data-setting-type="checkbox" />
              Auto-sync on launch
            </label>
          </div>
          <div class="formrow">
            <label>
              <input type="checkbox" id="sync_on_reconnect" data-setting-path="sync.autoSyncOnReconnect" data-setting-type="checkbox" />
              Auto-sync after reconnecting
            </label>
          </div>
          <p class="muted">
            These preferences are stored for future automation. Background sync behaviors can be expanded here later.
          </p>
        </div>
        <div class="card">
          <h2>Backup</h2>
          <div class="row row--space">
            <button class="btn" id="download_json_btn">Download JSON backup</button>
            <label class="btn btn--ghost" for="import_json_file">Import JSON</label>
            <input id="import_json_file" type="file" accept="application/json" style="display:none" />
          </div>
          <p class="muted">
            Import merges into your local data. You can then Sync to Drive if you want.
          </p>
        </div>
      </div>

      <div class="grid2">
        <div class="card">
          <h2>Defaults & appearance</h2>
          <div class="formrow">
            <label for="default_module">Default landing page</label>
            <select id="default_module" data-setting-path="ui.defaultModule">
              <option value="meetings">Meetings</option>
              <option value="update_queue">Update queue</option>
              <option value="projects">Projects</option>
              <option value="people">People</option>
              <option value="tasks">Tasks</option>
              <option value="settings">Settings</option>
            </select>
          </div>
          <div class="formrow">
            <label for="default_calendar_view">Default calendar view</label>
            <select id="default_calendar_view" data-setting-path="ui.defaultCalendarView">
              <option value="week">Week</option>
              <option value="month">Month</option>
            </select>
          </div>
          <div class="formrow">
            <label for="theme_mode">Theme</label>
            <select id="theme_mode" data-setting-path="ui.theme">
              <option value="dark">Dark mode</option>
              <option value="light">Light mode</option>
            </select>
          </div>
          <div class="formrow">
            <label for="default_person_label">Default person label</label>
            <input id="default_person_label" type="text" data-setting-path="person.defaultLabel" placeholder="e.g., Me" />
          </div>
          <p class="muted">
            Use these defaults to control where you land on launch and how your default person is labeled.
          </p>
        </div>

        <div class="card">
          <h2>Automation & sign-in</h2>
          <div class="formrow">
            <label for="sync_background_interval">Background sync cadence (seconds)</label>
            <input id="sync_background_interval" type="number" min="0" step="5" data-setting-path="sync.backgroundIntervalSeconds" data-setting-type="number" />
          </div>
          <div class="formrow">
            <label>
              <input type="checkbox" id="sync_auto_signin" data-setting-path="sync.autoSignInOnLaunch" data-setting-type="checkbox" />
              Attempt to reconnect to Drive on launch
            </label>
          </div>
          <p class="muted">
            Set cadence to 0 to disable background sync checks. Reconnect uses Google’s silent token refresh when available.
          </p>
        </div>
      </div>

      <div class="grid2">
        <div class="card">
          <h2>Update types</h2>
          <div class="formrow">
            <label for="update_type_labels">Update type labels (key: label)</label>
            <textarea id="update_type_labels" rows="6" data-setting-path="labels.updateTypes" data-setting-type="map" placeholder="update: Update"></textarea>
          </div>
          <div class="formrow">
            <label for="update_type_order">Update type order (comma-separated)</label>
            <input id="update_type_order" type="text" data-setting-path="order.updateTypes" data-setting-type="list" placeholder="update, action, decision" />
          </div>
        </div>

        <div class="card">
          <h2>Task vocabularies</h2>
          <div class="formrow">
            <label for="task_status_labels">Task status labels (key: label)</label>
            <textarea id="task_status_labels" rows="5" data-setting-path="labels.taskStatuses" data-setting-type="map" placeholder="todo: To do"></textarea>
          </div>
          <div class="formrow">
            <label for="task_status_order">Task status order (comma-separated)</label>
            <input id="task_status_order" type="text" data-setting-path="order.taskStatuses" data-setting-type="list" placeholder="todo, in_progress, blocked" />
          </div>
          <div class="formrow">
            <label for="task_priority_labels">Task priority labels (key: label)</label>
            <textarea id="task_priority_labels" rows="4" data-setting-path="labels.taskPriorities" data-setting-type="map" placeholder="high: High"></textarea>
          </div>
          <div class="formrow">
            <label for="task_priority_order">Task priority order (comma-separated)</label>
            <input id="task_priority_order" type="text" data-setting-path="order.taskPriorities" data-setting-type="list" placeholder="high, medium, low" />
          </div>
          <p class="muted">
            Keep keys consistent with existing data to avoid mismatches. New keys can be added for custom workflows.
          </p>
        </div>
      </div>
    </section>
  </main>

  <!-- Project creation lightbox (kept outside modules so it remains available across views) -->
  <div class="lightbox" id="topic_lightbox" aria-hidden="true">
    <div class="lightbox__backdrop" data-lightbox-close="true"></div>
    <div class="lightbox__panel" role="dialog" aria-modal="true" aria-labelledby="topic_lightbox_title">
      <div class="lightbox__header">
        <h3 id="topic_lightbox_title">Add a project</h3>
        <button class="iconbtn" data-lightbox-close="true" aria-label="Close project form">✕</button>
      </div>
      <div class="formrow">
        <label>Project name</label>
        <input id="topic_name_input" type="text" placeholder="e.g., Q4 planning" />
      </div>
      <div class="formrow">
        <label>Project color</label>
        <div id="topic_color_picker" class="color-picker" role="radiogroup" aria-label="Project color options"></div>
        <input id="topic_color_input" type="hidden" />
      </div>
      <div class="formrow">
        <label>Description</label>
        <textarea id="topic_description_input" rows="3" placeholder="Summarise what this project delivers."></textarea>
      </div>
      <div class="formrow">
        <label>Outcome</label>
        <textarea id="topic_outcome_input" rows="2" placeholder="State the desired outcome."></textarea>
      </div>
      <div class="formrow">
        <label>Benefits</label>
        <textarea id="topic_benefits_input" rows="2" placeholder="Highlight key benefits."></textarea>
      </div>
      <div class="formrow">
        <label>Target audience</label>
        <textarea id="topic_audience_input" rows="2" placeholder="Who is this for?"></textarea>
      </div>
      <div class="item__error" id="topic_lightbox_error" hidden></div>
      <div class="row row--space">
        <button class="btn btn--primary" id="topic_add_btn">Add project</button>
        <button class="btn btn--ghost" data-lightbox-close="true" type="button">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Project deletion confirmation lightbox -->
  <div class="lightbox" id="project_delete_lightbox" aria-hidden="true">
    <div class="lightbox__backdrop" data-lightbox-close="true"></div>
    <div class="lightbox__panel" role="dialog" aria-modal="true" aria-labelledby="project_delete_title">
      <div class="lightbox__header">
        <h3 id="project_delete_title">Delete project</h3>
        <button class="iconbtn" data-lightbox-close="true" aria-label="Close delete project modal">✕</button>
      </div>
      <p class="muted" id="project_delete_message">Delete this project?</p>
      <div class="item__error" id="project_delete_error" hidden></div>
      <div class="row row--space">
        <button class="btn btn--danger" id="project_delete_confirm_btn" type="button">Delete project</button>
        <button class="btn btn--ghost" data-lightbox-close="true" type="button">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Helpful usage reminder -->
  <footer class="footer">
    <div class="muted">
      Tip: Use it offline freely. When you’re online, hit <strong>Sync</strong>. The Drive file is stored hidden in your account.
    </div>
  </footer>

  <!-- Application logic -->
  <script src="app.js"></script>

  <!-- Google API client library -->
  <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
  <!-- Google Identity Services -->
  <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
</body>
</html>
